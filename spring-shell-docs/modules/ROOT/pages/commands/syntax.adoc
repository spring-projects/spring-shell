[[syntax]]
= Command Syntax

ifndef::snippets[:snippets: ../../test/java/org/springframework/shell/docs]

== Options and arguments

Command options and arguments can be defined using method parameters:

[source, java, indent=0]
----
include::{snippets}/CommandAnnotationSnippets.java[tag=command-option-arg]
----

Options are defined using `@Option` annotation, while arguments are defined using `@Argument` annotation.
Options are named, while arguments are positional. Options can have short names (single character) and long names (multi-character).

Options can be validated using the Bean Validation API by adding validation annotations to the method parameters, see the xref:commands/validation.adoc[Validating Command Options] section for more details.

== Parsing rules

Spring Shell follows the same parsing rules as Spring Boot, with enhanced capabilities following the POSIX style.
Options can be specified in the form `-o=value` and `--option=value`. Options and arguments can be specified in any order.
Arguments are 0-based indexed among other arguments:

[source,shell]
----
CommandSyntax  ::= CommandName [SubCommandName]* [Option | Argument]*
CommandName    ::= String
SubCommandName ::= String
Option         ::= ShortOption | LongOption
ShortOption    ::= '-' Char ('=' String)?
LongOption     ::= '--' String ('=' String)?
Argument       ::= String
----

For example:

[source,shell]
----
$>mycommand mysubcommand --option1=value1 arg1 -o2=value2 arg2
----

IMPORTANT: Options cannot be specified using the `--option value` or `-o value` syntax. Only the `=` syntax is supported. Moreover, short options cannot be grouped (e.g., `-abc` is not supported).

If your command does not have options, then arguments must be separated using "--" (POSIX style) to avoid ambiguity between arguments and subcommands:

[source,shell]
----
$>mycommand -- arg1 arg2
----

Similarly, if your command defines subcommands that are used without options, then arguments must also be separated using "--" (POSIX style) to avoid ambiguity between arguments and subcommands:

[source,shell]
----
$>mycommand mysubcommand -- arg1 arg2
----

TIP: To avoid ambiguity, named options should be preferred over positional arguments whenever possible, especially when subcommands are involved (see https://clig.dev/#arguments-and-flags[Command Line Interface Guidelines]).

== Customizing parsing rules

Spring Shell 4 provides a new API called `CommandParser` that allows you to customize the command parsing rules.
If the default parsing rules do not fit your needs, you can implement your own parser by implementing the `CommandParser` interface.
Once the custom parser is implemented, you can register it as a bean in the application context, and Spring Shell will use it for parsing commands.